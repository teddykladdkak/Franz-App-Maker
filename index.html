<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Franz App Maker</title>
		<style type="text/css">
			html, body {
				padding: 0px;
				margin: 0px;
			}
			input, textarea, button {
				display: block;
				width: 100%;
				box-sizing : border-box;
				font-size: 20px;
			}
			textarea {
				height: 200px;
				max-width: 100%;
			}
			p {
				margin-bottom: 0px;
				font-size: 20px;
			}
			body {
				background-color: darkgrey;
			}
			.wrapper {
				width: 90%;
				max-width: 600px;
				margin: 0px auto;
				background-color: white;
				padding: 10px;
			}
			.line {
				border-top: solid 1px #000;
			}
			#todolist {
				display: block;
				margin-bottom: 20px;
			}
			#iconpreview, #iconpreview svg {
				display: inline-block;
				width: 64px;
				height: 64px;
				max-width: 64px;
				max-height: 64px;
			}
			.svg-inline--fa {
				width: 20px;
				height: 20px;
			}
		</style>
		<script type="text/javascript">
			function getBase64(file) {
				var reader = new FileReader();
				reader.readAsDataURL(file);
				reader.onload = function () {
					console.log(reader.result)
					var svgdata = '<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="96px" height="96px" viewBox="0 0 96 96" enable-background="new 0 0 96 96" xml:space="preserve">  <image id="image0" width="96" height="96" x="0" y="0" xlink:href="' + reader.result + '" /></svg>';
					document.getElementById('svg').value = svgdata;
					document.getElementById('iconpreview').innerHTML = svgdata;
				};
				reader.onerror = function (error) {
					console.log('Error: ', error);
				};
			};
			function test(){
				document.getElementById('projectname').value = 'Test Application';
				document.getElementById('description').value = 'This application test the meening of hello world...';
				document.getElementById('username').value = 'TheDev';
				document.getElementById('email').value = 'DevOnline@mail.com';
				document.getElementById('url').value = 'https://test.com';
				document.getElementById('advanced').value = 'var number = document.getElementById(\'notification\').value;';
			};
			function removeinfo(){
				document.getElementById('projectname').value = '';
				document.getElementById('description').value = '';
				document.getElementById('username').value = '';
				document.getElementById('email').value = '';
				document.getElementById('url').value = '';
				document.getElementById('advanced').value = '';
			};
			function show(id){
				var allwrappers = document.getElementsByClassName('wrapper');
				for (var i = allwrappers.length - 1; i >= 0; i--) {
					allwrappers[i].setAttribute('style', 'display: none;');
				};
				document.getElementById(id).removeAttribute('style');
			};
		</script>
	</head>
	<body onload="load();">
		<div id="todo" class="wrapper">
			<p>This is a project that aims to make the process of making new apps for the plattform "Franz" more easy.</p>
			<p>Note! The code will be marked MIT, to enabel other developers in the community to use the same code.</p>
			<h2>Todo</h2>
			<p>Do you want to edit a current project or make a new?</p>
			<span id="todolist"></span>
			<button onclick="removeinfo();show('wrapper');"><svg aria-hidden="true" data-prefix="fas" data-icon="plus-circle" class="svg-inline--fa fa-plus-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"></path></svg> New</button>
		</div>
		<div id="errorfranz" style="display: none;" class="wrapper">
			<h2>Error!</h2>
			<p>This application cant find that Franz is installed on your computer. You need to install Franz before you can use this applikation.</p>
		</div>
		<div id="wrapper" style="display: none;" class="wrapper">
			<button onclick="location.reload();"><svg aria-hidden="true" data-prefix="fas" data-icon="arrow-circle-left" class="svg-inline--fa fa-arrow-circle-left fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zm28.9-143.6L209.4 288H392c13.3 0 24-10.7 24-24v-16c0-13.3-10.7-24-24-24H209.4l75.5-72.4c9.7-9.3 9.9-24.8.4-34.3l-11-10.9c-9.4-9.4-24.6-9.4-33.9 0L107.7 239c-9.4 9.4-9.4 24.6 0 33.9l132.7 132.7c9.4 9.4 24.6 9.4 33.9 0l11-10.9c9.5-9.5 9.3-25-.4-34.3z"></path></svg> Back</button>
			<button onclick="test();"><svg aria-hidden="true" data-prefix="fas" data-icon="vial" class="svg-inline--fa fa-vial fa-w-15" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path fill="currentColor" d="M477.7 186.1L309.5 18.3c-3.1-3.1-8.2-3.1-11.3 0l-34 33.9c-3.1 3.1-3.1 8.2 0 11.3l11.2 11.1L33 316.5c-38.8 38.7-45.1 102-9.4 143.5 20.6 24 49.5 36 78.4 35.9 26.4 0 52.8-10 72.9-30.1l246.3-245.7 11.2 11.1c3.1 3.1 8.2 3.1 11.3 0l34-33.9c3.1-3 3.1-8.1 0-11.2zM318 256H161l148-147.7 78.5 78.3L318 256z"></path></svg> Test</button>
			<h2 class="line">Information</h2>
			<p>Namn</p>
			<input type="text" id="projectname">
			<p>Small description</p>
			<textarea id="description"></textarea>
			<p>Your name</p>
			<input type="name" id="username">
			<p>E-mail? (Not needed)</p>
			<input type="email" id="email">
			<p>Link to webpage</p>
			<input type="text" id="url">

			<h2>Ikon</h2>
			<p>Uppload image (".jpg" or ".png")</p>
			<input type="file" id="iconone" onchange="getBase64(this.files[0]);">
			<p>Preview:</p>
			<span id="iconpreview"></span>

			<h2 class="line">Advanced</h2>
			<p>Script to search for number of notifications/messages.</p>
			<p>You need to end the script with variable "number".</p>
			<p>Leave emty if you dont know or want this functionality.</p>
			<a href="#" onclick="insertAtCaret('advanced', 'Det funkar!');return false;">[Test]</a>
			<a href="#" onclick="insertAtCaret('advanced', 'document.getElementById(\'\');');return false;">[ID]</a>
			<a href="#" onclick="insertAtCaret('advanced', 'document.getElementsByClassName(\'\')[0];');return false;">[Class]</a>
			<a href="#" onclick="insertAtCaret('advanced', 'document.getElementsByTagName(\'\')[0];');return false;">[TagName]</a>
			<a href="#" onclick="insertAtCaret('advanced', 'document.getElementsByName(\'\')[0];');return false;">[Name]</a>
			<a href="#" onclick="insertAtCaret('advanced', 'var  = ');return false;">[var]</a>
			<a href="#" onclick="insertAtCaret('advanced', '\'use strict\';\n\nmodule.exports = Franz => {\n  const getMessages = function getMessages() {\n    // get unread feeds\n    \n    // set Franz badge\n    Franz.setBadge(result);\n  };\n  // check for new messages every second and update Franz badge\n  Franz.loop(getMessages);\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdtYWlsL3dlYnZpZXcuanMiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsIkZyYW56IiwiZ2V0TWVzc2FnZXMiLCJjb3VudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImxlbmd0aCIsImdldEF0dHJpYnV0ZSIsInBhcnNlSW50IiwicmVwbGFjZSIsImlzTmFOIiwic2V0QmFkZ2UiLCJsb29wIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxPQUFPQyxPQUFQLEdBQWtCQyxLQUFELElBQVc7QUFDMUIsUUFBTUMsY0FBYyxTQUFTQSxXQUFULEdBQXVCO0FBQ3pDLFFBQUlDLFFBQVEsQ0FBWjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxRQUFJQyxTQUFTQyxzQkFBVCxDQUFnQyxPQUFoQyxFQUF5Q0MsTUFBekMsR0FBa0QsQ0FBdEQsRUFBeUQ7QUFDdkRILGNBQVFDLFNBQVNDLHNCQUFULENBQWdDLE9BQWhDLEVBQXlDQyxNQUFqRDtBQUNEOztBQUVELFFBQUlGLFNBQVNDLHNCQUFULENBQWdDLFNBQWhDLEVBQTJDQyxNQUEzQyxHQUFvRCxDQUF4RCxFQUEyRDtBQUN6RDtBQUNBLFVBQUlGLFNBQVNDLHNCQUFULENBQWdDLFNBQWhDLEVBQTJDLENBQTNDLEVBQThDRSxZQUE5QyxDQUEyRCxZQUEzRCxLQUE0RSxJQUFoRixFQUFzRjtBQUNwRkosZ0JBQVFLLFNBQVNKLFNBQVNDLHNCQUFULENBQWdDLFNBQWhDLEVBQTJDLENBQTNDLEVBQThDRSxZQUE5QyxDQUEyRCxZQUEzRCxFQUF5RUUsT0FBekUsQ0FBaUYsVUFBakYsRUFBNkYsRUFBN0YsQ0FBVCxFQUEyRyxFQUEzRyxDQUFSO0FBQ0Q7O0FBRUQ7QUFDQSxVQUFJTCxTQUFTQyxzQkFBVCxDQUFnQyxTQUFoQyxFQUEyQyxDQUEzQyxFQUE4Q0UsWUFBOUMsQ0FBMkQsT0FBM0QsS0FBdUUsSUFBM0UsRUFBaUY7QUFDL0VKLGdCQUFRSyxTQUFTSixTQUFTQyxzQkFBVCxDQUFnQyxTQUFoQyxFQUEyQyxDQUEzQyxFQUE4Q0UsWUFBOUMsQ0FBMkQsT0FBM0QsRUFBb0VFLE9BQXBFLENBQTRFLFVBQTVFLEVBQXdGLEVBQXhGLENBQVQsRUFBc0csRUFBdEcsQ0FBUjtBQUNEO0FBQ0Y7O0FBRUQ7QUFDQSxRQUFJQyxNQUFNUCxLQUFOLENBQUosRUFBa0I7QUFDaEJBLGNBQVEsQ0FBUjtBQUNEOztBQUVEO0FBQ0FGLFVBQU1VLFFBQU4sQ0FBZVIsS0FBZjtBQUNELEdBL0JEOztBQWlDQTtBQUNBRixRQUFNVyxJQUFOLENBQVdWLFdBQVg7QUFDRCxDQXBDRCIsImZpbGUiOiJnbWFpbC93ZWJ2aWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSAoRnJhbnopID0+IHtcbiAgY29uc3QgZ2V0TWVzc2FnZXMgPSBmdW5jdGlvbiBnZXRNZXNzYWdlcygpIHtcbiAgICBsZXQgY291bnQgPSAwO1xuXG4gICAgLy8gRWFjaCB0ZXN0IGlzIGRvbmUgaW4gb3JkZXIgb2YgbGVhc3QgYWNjdXJhdGUgKGJ1dCBtb3N0IHJvYnVzdClcbiAgICAvLyAtPiBtb3N0IGFjY3VyYXRlIChidXQgbGVhc3Qgcm9idXN0KVxuICAgIC8vIGZvciByZWxpYWJpbGl0eSBvZiBhdCBsZWFzdCBnZXR0aW5nIGEgcmVzdWx0XG5cbiAgICAvLyAzcmQgYmVzdCB0ZXN0IChiYXNpYywgbGVzcyBhY2N1cmF0ZSBidXQgT0sgaWYgbm90aGluZyBlbHNlIHdvcmtzKVxuICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd6QSB6RScpLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvdW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnekEgekUnKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ0otS2UgbjAnKS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyAybmQgYmVzdCAobW9yZSBkZXRhaWxlZCBjaGVjaywgbXVjaCBtb3JlIGFjY3VyYXRlIGlmIGF2YWlsYWJsZSlcbiAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdKLUtlIG4wJylbMF0uZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJykgIT0gbnVsbCkge1xuICAgICAgICBjb3VudCA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ0otS2UgbjAnKVswXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnKS5yZXBsYWNlKC9bXjAtOS5dL2csICcnKSwgMTApO1xuICAgICAgfVxuXG4gICAgICAvLyAxc3QgYmVzdFxuICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ0otS2UgbjAnKVswXS5nZXRBdHRyaWJ1dGUoJ3RpdGxlJykgIT0gbnVsbCkge1xuICAgICAgICBjb3VudCA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ0otS2UgbjAnKVswXS5nZXRBdHRyaWJ1dGUoJ3RpdGxlJykucmVwbGFjZSgvW14wLTkuXS9nLCAnJyksIDEwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBKdXN0IGluY2FzZSB3ZSBkb24ndCBlbmQgdXAgd2l0aCBhIG51bWJlciwgc2V0IGl0IGJhY2sgdG8gemVybyAocGFyc2VJbnQgY2FuIHJldHVybiBOYU4pXG4gICAgaWYgKGlzTmFOKGNvdW50KSkge1xuICAgICAgY291bnQgPSAwO1xuICAgIH1cblxuICAgIC8vIHNldCBGcmFueiBiYWRnZVxuICAgIEZyYW56LnNldEJhZGdlKGNvdW50KTtcbiAgfTtcblxuICAvLyBjaGVjayBmb3IgbmV3IG1lc3NhZ2VzIGV2ZXJ5IHNlY29uZCBhbmQgdXBkYXRlIEZyYW56IGJhZGdlXG4gIEZyYW56Lmxvb3AoZ2V0TWVzc2FnZXMpO1xufTtcbiJdfQ==');document.getElementById('advanced').scrollLeft = 0;return false;">[All Franz Code]</a>
			<textarea wrap="off" id="advanced"></textarea>
			<p>Dont forget to end with variable "number", to tell Franz how many notifications ther is.</p>
			<h2 class="line">Start build</h2>
			<button onclick="build('false');"><svg aria-hidden="true" data-prefix="fas" data-icon="cookie-bite" class="svg-inline--fa fa-cookie-bite fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M510.52 255.82c-69.97-.85-126.47-57.69-126.47-127.86-70.17 0-127-56.49-127.86-126.45-27.26-4.14-55.13.3-79.72 12.82l-69.13 35.22a132.221 132.221 0 0 0-57.79 57.81l-35.1 68.88a132.645 132.645 0 0 0-12.82 80.95l12.08 76.27a132.521 132.521 0 0 0 37.16 72.96l54.77 54.76a132.036 132.036 0 0 0 72.71 37.06l76.71 12.15c27.51 4.36 55.7-.11 80.53-12.76l69.13-35.21a132.273 132.273 0 0 0 57.79-57.81l35.1-68.88c12.56-24.64 17.01-52.58 12.91-79.91zM176 368c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm32-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm160 128c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"></path></svg> Start building!</button>
		</div>
		<div id="instructions" style="display: none;" class="wrapper">
			<h2 class="line">Instructions</h2>
			<h3>Step 1</h3>
			<p>Click the "Start building!" button above. All files will automatically be downloaded with your premission. Or you can manually create them with the code further down the page.</p>
			<h3>Step 2</h3>
			<p>Put all the files in the same directory, that you name the same as the project.</p>
			<h3>Step 3</h3>
			<p>Move the folder with all files to:</p>
			<ul>
			<li>Mac: ~/Library/Application Support/Franz/recipes/dev/</li>
			<li>Windows: %appdata%/Franz/recipes/dev/</li>
			<li>Linux: ~/.config/Franz/recipes/dev</li>
			</ul>
			<p>(The "dev" folder may not excist, then you have to create it.)</p>
			<h3>Step 4</h3>
			<p>In Franz menu click "View" and "Reload Franz"</p>
			<h3>Step 5</h3>
			<p>Klick the "Add new service" icon ("+").</p>
			<h3>Step 6</h3>
			<p>Choose the "development" tab. And the rest is the same as usual.</p>
			<h3>For more reading</h3>
			<p><a href="https://github.com/meetfranz/plugins/blob/master/docs/integration.md" target="_blank">https://github.com/meetfranz/plugins/blob/master/docs/integration.md</a></p>
		</div>
		<div id="result" style="display: none;" class="wrapper">
			<h2 class="line">icon.svg</h2>
			<textarea id="svg"></textarea>
			<h2 class="line">index.js</h2>
			<textarea id="indexjs"></textarea>
			<h2 class="line">package.json</h2>
			<textarea id="packagejson"></textarea>
			<h2 class="line">webview.js</h2>
			<textarea id="webviewjs"></textarea>
		</div>
		<script type="text/javascript">
			var {ipcRenderer, remote} = require('electron');  
			var main = remote.require("./main.js");
			function load(){
				ipcRenderer.send('load', '0');
			};
			ipcRenderer.on('cantfindfranz', (event, arg) => {
				document.getElementById('errorfranz').removeAttribute('style');
			});
			ipcRenderer.on('oldprojects', (event, arg) => {
				var buttonwrapper = document.getElementById('todolist');
				for (var i = arg.length - 1; i >= 0; i--) {
					if(arg[i] == '.DS_Store'){}else{
						var button = document.createElement('button');
							button.setAttribute('value', arg[i]);
							button.setAttribute('onclick', 'loadproject(this)');
							var buttontext = document.createTextNode(arg[i].toUpperCase());
							button.appendChild(buttontext);
						buttonwrapper.appendChild(button);
					};
				};
				console.log(arg);
				document.getElementById('todo').removeAttribute('style');
			});
			function loadproject(element){
				ipcRenderer.send('loadproject', element.value);
			};
			ipcRenderer.on('pasteproject', (event, arg) => {
				console.log(arg)
				document.getElementById('projectname').value = arg.projectname;
				document.getElementById('description').value = arg.description;
				var usernames = [];
				var emails = [];
				for (var i = arg.athors.length - 1; i >= 0; i--) {
					usernames.push(arg.athors[i].name);
					emails.push(arg.athors[i].email);
				};
				document.getElementById('username').value = usernames.join(', ');
				document.getElementById('email').value = emails.join(', ');
				document.getElementById('url').value = arg.url;
				document.getElementById('advanced').value = arg.advanced;
				document.getElementById('svg').value = arg.iconone;
				document.getElementById('iconpreview').innerHTML = arg.iconone;
				show('wrapper');
			});
			function build(override){
				var elementtoget = ['projectname', 'description', 'username', 'email', 'url', 'svg', 'advanced'];
				var data = {};
				for (var i = elementtoget.length - 1; i >= 0; i--) {
					var info = document.getElementById(elementtoget[i]).value;
					data[elementtoget[i]] = info;
					data.override = override;
				};
				console.log(data);
				ipcRenderer.send('build', data);
			};
			ipcRenderer.on('projectexist', (event, arg) => {
				var r = confirm("Previous project were found with the same name, are you sure you want to overwrite these files. Otherwise, change the name of the projet.");
				if (r == true) {
				    build('true');
				} else {};
			});
			ipcRenderer.on('projectsaved', (event, arg) => {
				alert('Projektet sparades!')
				location.reload();
			});
		</script>
		<script type="text/javascript">
			function insertAtCaret(areaId, text) {
				var txtarea = document.getElementById(areaId);
				if (!txtarea) {
					return;
				}

				var scrollPos = txtarea.scrollTop;
				var strPos = 0;
				var br = ((txtarea.selectionStart || txtarea.selectionStart == '0') ? "ff" : (document.selection ? "ie" : false));
				if (br == "ie") {
					txtarea.focus();
					var range = document.selection.createRange();
						range.moveStart('character', -txtarea.value.length);
					strPos = range.text.length;
				} else if (br == "ff") {
					strPos = txtarea.selectionStart;
				}

				var front = (txtarea.value).substring(0, strPos);
				var back = (txtarea.value).substring(strPos, txtarea.value.length);
					txtarea.value = front + text + back;
					strPos = strPos + text.length;
				if (br == "ie") {
					txtarea.focus();
					var ieRange = document.selection.createRange();
						ieRange.moveStart('character', -txtarea.value.length);
						ieRange.moveStart('character', strPos);
						ieRange.moveEnd('character', 0);
						ieRange.select();
				} else if (br == "ff") {
					txtarea.selectionStart = strPos;
					txtarea.selectionEnd = strPos;
					txtarea.focus();
				}
				txtarea.scrollTop = scrollPos;
			}
		</script>
	</body>
</html>